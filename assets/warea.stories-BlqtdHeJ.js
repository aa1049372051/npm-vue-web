import{i as b}from"./httpV2-D5Gy0SDP.js";import{j as c,k as l,x as o,y as u,A as m,q as L,B as g,v as f,l as y,u as v,F as D}from"./vue.esm-bundler-CNtYpaDd.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C={name:"WArea",setup(){},props:{provinceId:{type:[String,Number],default:0},disabled:{type:Boolean,default(){return!1}},showEmpty:{type:Boolean,default(){return!1}},provinceName:{type:[String,Number],default:""},cityId:{type:[String,Number],default:0},cityName:{type:[String,Number],default:""},areaId:{type:[String,Number],default:0},areaName:{type:[String,Number],default:""},rank:{type:Number,default:3},emptyStr:{type:Array,default(){return["选择省","选择市","选择区县"]}},htmlOptions:{type:Object,default(){return{}}},clearable:{type:Boolean,default(){return!0}},ruleStr:{type:Array,default(){return["请选择省","请选择市","请选择区"]}},isEmpty:{type:Boolean,default(){return!1}},isCheck:{type:Boolean,default(){return!0}},isKeyUp:{type:Boolean,default(){return!1}},areaClass:{type:Object,default(){return{p:"width100",c:"width100",a:"width100"}}},isProvinceAll:{type:Boolean,default(){return!0}},disabledRank:{type:Number,default(){return 0}}},data(){return{provinceDisabled:!1,provinceList:[],cityList:[],areaList:[],lock:!1,defaultDate:{size:"small"},ruleForm:{myProvinceID:"",myCityID:"",myAreaID:""},pTimeout:"",cTimeOut:"",aTimeOut:"",cDisabled:!1,aDisabled:!1}},methods:{keyUp(){this.isKeyUp&&this.$emit("changeFocus")},getCity(e){if(this.$emit("update:provinceId",e),clearTimeout(this.pTimeout),!e||e==0){this.$emit("update:cityId",""),this.$emit("update:cityName",""),this.$emit("update:provinceName",""),this.ruleForm.myCityID="",this.cityList=[],this.getArea();return}this.$refs.ruleForm.clearValidate();let a=sessionStorage.getItem(e)?JSON.parse(sessionStorage.getItem(e)):[];if(a&&Object.keys(a).length){this.cityList=a;let t=this.cityId,i="";t&&parseInt(t/1e4)==parseInt(a[0].id/1e4)?i=t:t==0&&this.showEmpty?i=0:i=a[0].id,this.$emit("update:cityId",i),clearTimeout(this.cTimeOut),this.ruleForm.myCityID=i,this.getName();return}this.cDisabled=!0,this.aDisabled=!0,b.post("pqs/are001",{grade:3,parentID:e}).then(t=>{if(this.cDisabled=!1,this.aDisabled=!1,t.data.retCode==200){a=t.data.result.areaList||[],a?(a.forEach(n=>{n.label=n.name,n.value=n.id+""}),sessionStorage.setItem(e,JSON.stringify(a))):a=[],this.cityList=a;let i=this.cityId,r="";i&&parseInt(i/1e4)==parseInt(a[0].id/1e4)?r=i:r=a[0].id,this.$emit("update:cityId",r),clearTimeout(this.cTimeOut),this.ruleForm.myCityID=r,this.getName()}},()=>{this.cDisabled=!1,this.aDisabled=!1})},getArea(e){if(!e||e==0){this.areaList=[],this.$emit("update:areaId",""),this.getAreaInfo(),this.ruleForm.myAreaID="";return}let a=sessionStorage.getItem(e)?JSON.parse(sessionStorage.getItem(e)):[];if(a&&Object.keys(a).length){this.areaList=a;let t=this.areaId,i="";t&&parseInt(t/100)==parseInt(a[0].id/100)?i=t:t==0&&this.showEmpty?i=0:i=a[0].id,this.$emit("update:areaId",i),clearTimeout(this.aTimeOut),this.ruleForm.myAreaID=i,this.getName();return}this.aDisabled=!0,b.post("pqs/are001",{grade:4,parentID:e}).then(t=>{if(this.aDisabled=!1,t.data.retCode==200){a=t.data.result.areaList||[],a&&a.forEach(n=>{n.label=n.name,n.value=n.id+""}),sessionStorage.setItem(e,JSON.stringify(a)),this.areaList=a;let i=this.areaId,r="";i&&parseInt(i/100)==parseInt(a[0].id/100)?r=i:r=a[0].id,this.$emit("update:areaId",r),this.getName(),this.ruleForm.myAreaID=r;return}},()=>{this.aDisabled=!1})},getName(){clearTimeout(this.aTimeOut),this.aTimeOut=setTimeout(()=>{this.$emit("update:provinceName",this.$refs.province.selectedLabel),this.rank!=1&&this.$emit("update:cityName",this.$refs.city.selectedLabel),this.rank==3&&this.$emit("update:areaName",this.$refs.area.selectedLabel),this.$emit("change")},100)},getData(){return{provinceName:this.$refs.province&&this.$refs.province.selectedLabel,cityName:this.$refs.city&&this.$refs.city.selectedLabel,areaName:this.$refs.area&&this.$refs.area.selectedLabel,provinceId:this.ruleForm.myProvinceID,cityId:this.ruleForm.myCityID,areaId:this.ruleForm.myAreaID}},validate(){let e="";return this.$refs.ruleForm.validate(a=>{e=a}),e},reset(){let e;this.isEmpty?e=0:e=parseInt(this.provinceList[0].id),this.$emit("update:provinceId",e),this.ruleForm.myProvinceID=e,this.getCity(e),this.$refs.ruleForm.resetFields()},clear(){this.$refs.ruleForm.clearValidate()},getAreaInfo(){this.$emit("arealist",{provinceId:this.ruleForm.myProvinceID,cityId:this.ruleForm.myCityID,areaId:this.ruleForm.myAreaID})},getProvince(){let e=window.sessionStorage.getItem("newProvinceList");e?this.provinceList=e?JSON.parse(e):[]:(this.provinceDisabled=!0,b.post("pqs/are001",{grade:2,parentID:0}).then(a=>{if(a.data.retCode==200){let t=a.data.result.areaList||[];t.forEach(i=>{i.label=i.name,i.value=i.id+""}),this.provinceList=t,window.sessionStorage.setItem("newProvinceList",JSON.stringify(t))}}).finally(()=>{this.$nextTick(()=>{this.provinceList,this.provinceDisabled=!1})}))}},computed:{rowNum(){return this.rank==3?[8,8,8]:this.rank==2?[12,12,0]:[24,0,0]}},watch:{provinceId(e){e==0&&!this.showEmpty&&(e=""),this.ruleForm.myProvinceID=e},cityId(e){e==0&&!this.showEmpty&&(e=""),this.ruleForm.myCityID=e},areaId(e){e==0&&!this.showEmpty&&(e=""),this.ruleForm.myAreaID=e},"ruleForm.myProvinceID"(e,a){if(e&&typeof e!="number")return this.ruleForm.myProvinceID=parseInt(e)||e,!1;this.getCity(e)},"ruleForm.myCityID"(e,a){if(e&&typeof e!="number")return this.ruleForm.myCityID=parseInt(e)||e,!1;e!==a&&(this.$emit("update:cityId",e),this.getName(),clearTimeout(this.cTimeOut),this.getArea(e))},"ruleForm.myAreaID"(e,a){if(e&&typeof e!="number")return this.ruleForm.myAreaID=parseInt(e)||e,!1;e!==a&&e&&(this.$emit("update:areaId",e),clearTimeout(this.cTimeOut),this.getName()),e===""&&(this.$emit("update:areaId",""),this.getName()),e===0&&(this.$emit("update:areaId",0),this.getName())},provinceList(e){e&&Object.keys(e).length&&!this.isEmpty&&!this.lock&&Object.keys(e).length&&(this.lock=!0,this.ruleForm.myProvinceID=e[0].id,this.$emit("update:provinceId",e[0].id))}},beforeDestroy(){clearTimeout(this.pTimeout),clearTimeout(this.cTimeOut),clearTimeout(this.aTimeOut)},mounted(){this.getProvince(),window.sessionStorage.getItem("newProvinceList")?this.provinceId&&(this.ruleForm.myProvinceID=this.provinceId?this.provinceId:"",this.ruleForm.myCityID=this.cityId?this.cityId:"",this.ruleForm.myAreaID=this.areaId?this.areaId:""):setTimeout(()=>{this.provinceId&&(this.ruleForm.myProvinceID=this.provinceId?this.provinceId:"",this.ruleForm.myCityID=this.cityId?this.cityId:"",this.ruleForm.myAreaID=this.areaId?this.areaId:"")},1500)}},A={class:"in-block pad-bot4",style:{}},V={key:0,class:"in-block pad-bot4",style:""},O={key:1,class:"in-block mar-r0 pad-bot4"};function T(e,a,t,i,r,n){const d=c("el-option"),p=c("el-select"),I=c("el-form-item"),_=c("el-form"),w=c("el-row");return l(),o(w,null,{default:u(()=>[m(_,{model:r.ruleForm,ref:"ruleForm",inline:"",size:""},{default:u(()=>[L("div",A,[m(I,{prop:"myProvinceID",rules:[{required:t.isCheck==!0,message:t.ruleStr[0]||" "}]},{default:u(()=>[m(p,{class:g(t.areaClass.p||{}),modelValue:r.ruleForm.myProvinceID,"onUpdate:modelValue":a[0]||(a[0]=s=>r.ruleForm.myProvinceID=s),disabled:t.disabled||r.provinceDisabled||t.disabledRank>0,clearable:t.clearable,ref:"province",placeholder:t.emptyStr[0]},{default:u(()=>[t.showEmpty&&r.provinceList&&r.provinceList.length>0&&t.isProvinceAll?(l(),o(d,{key:0,label:"全部",value:0})):f("",!0),(l(!0),y(D,null,v(r.provinceList,s=>(l(),o(d,{key:s.value,label:s.label,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["class","modelValue","disabled","clearable","placeholder"])]),_:1},8,["rules"])]),t.rank!=1?(l(),y("div",V,[m(I,{prop:"myCityID",rules:[{required:t.isCheck==!0,message:t.ruleStr[1]||" "}]},{default:u(()=>[m(p,{class:g(t.areaClass.c||{}),disabled:r.cDisabled||t.disabled||t.disabledRank>1,modelValue:r.ruleForm.myCityID,"onUpdate:modelValue":a[1]||(a[1]=s=>r.ruleForm.myCityID=s),ref:"city",placeholder:t.emptyStr[1]},{default:u(()=>[t.showEmpty&&r.cityList&&r.cityList.length>0?(l(),o(d,{key:0,label:"全部",value:0})):f("",!0),(l(!0),y(D,null,v(r.cityList,s=>(l(),o(d,{key:s.value,label:s.label,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["class","disabled","modelValue","placeholder"])]),_:1},8,["rules"])])):f("",!0),t.rank==3?(l(),y("div",O,[m(I,{prop:"myAreaID",rules:[{required:t.isCheck==!0,message:t.ruleStr[2]||" "}]},{default:u(()=>[m(p,{class:g(t.areaClass.a||{}),disabled:r.aDisabled||t.disabled||t.disabledRank>2,modelValue:r.ruleForm.myAreaID,"onUpdate:modelValue":a[2]||(a[2]=s=>r.ruleForm.myAreaID=s),ref:"area",placeholder:t.emptyStr[2],onChange:n.keyUp},{default:u(()=>[t.showEmpty&&r.areaList&&r.areaList.length>0?(l(),o(d,{key:0,label:"全部",value:0})):f("",!0),(l(!0),y(D,null,v(r.areaList,s=>(l(),o(d,{key:s.value,label:s.label,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["class","disabled","modelValue","placeholder","onChange"])]),_:1},8,["rules"])])):f("",!0)]),_:1},8,["model"])]),_:1})}const E=S(C,[["render",T]]);C.__docgenInfo={displayName:"WArea",exportName:"default",description:"",tags:{},props:[{name:"provinceId",type:{name:"string|number"},defaultValue:{func:!1,value:"0"}},{name:"disabled",type:{name:"boolean"},defaultValue:{func:!0,value:`function() {
  return false;
}`}},{name:"showEmpty",type:{name:"boolean"},defaultValue:{func:!0,value:`function() {
  return false;
}`}},{name:"provinceName",type:{name:"string|number"},defaultValue:{func:!1,value:'""'}},{name:"cityId",type:{name:"string|number"},defaultValue:{func:!1,value:"0"}},{name:"cityName",type:{name:"string|number"},defaultValue:{func:!1,value:'""'}},{name:"areaId",type:{name:"string|number"},defaultValue:{func:!1,value:"0"}},{name:"areaName",type:{name:"string|number"},defaultValue:{func:!1,value:'""'}},{name:"rank",type:{name:"number"},defaultValue:{func:!1,value:"3"}},{name:"emptyStr",type:{name:"array"},defaultValue:{func:!1,value:'["选择省", "选择市", "选择区县"]'}},{name:"htmlOptions",type:{name:"object"},defaultValue:{func:!1,value:"{}"}},{name:"clearable",type:{name:"boolean"},defaultValue:{func:!0,value:`function() {
  return true;
}`}},{name:"ruleStr",type:{name:"array"},defaultValue:{func:!1,value:'["请选择省", "请选择市", "请选择区"]'}},{name:"isEmpty",type:{name:"boolean"},defaultValue:{func:!0,value:`function() {
  return false;
}`}},{name:"isCheck",type:{name:"boolean"},defaultValue:{func:!0,value:`function() {
  return true;
}`}},{name:"isKeyUp",type:{name:"boolean"},defaultValue:{func:!0,value:`function() {
  return false;
}`}},{name:"areaClass",type:{name:"object"},defaultValue:{func:!1,value:'{ p: "width100", c: "width100", a: "width100" }'}},{name:"isProvinceAll",type:{name:"boolean"},defaultValue:{func:!0,value:`function() {
  return true;
}`}},{name:"disabledRank",type:{name:"number"},defaultValue:{func:!0,value:`function() {
  return 0;
}`}}],events:[{name:"changeFocus"},{name:"update:provinceId",type:{names:["undefined"]}},{name:"update:cityId",type:{names:["undefined"]}},{name:"update:cityName",type:{names:["undefined"]}},{name:"update:provinceName",type:{names:["undefined"]}},{name:"update:areaId",type:{names:["undefined"]}},{name:"update:areaName",type:{names:["undefined"]}},{name:"change"},{name:"arealist",type:{names:["undefined"]}}],sourceFiles:["/home/runner/work/npm-vue-web/npm-vue-web/packages/components/warea/src/main.vue"]};const P={component:E,tags:["autodocs"],title:"COMPONENTS/WArea",argTypes:{},decorators:[()=>({template:'<div style="margin: 3em;">请选择省市区:<story/></div>'})],parameters:{componentSubtitle:"省市区组件",docs:{description:{component:"选择省市区组件"}}}},h={args:{},parameters:{docs:{description:{story:"省市区组件基础用法"}}}};var F,N,k;h.parameters={...h.parameters,docs:{...(F=h.parameters)==null?void 0:F.docs,source:{originalSource:`{
  args: {},
  parameters: {
    docs: {
      description: {
        story: "省市区组件基础用法"
      }
    }
  }
}`,...(k=(N=h.parameters)==null?void 0:N.docs)==null?void 0:k.source}}};const B=["Base"],q=Object.freeze(Object.defineProperty({__proto__:null,Base:h,__namedExportsOrder:B,default:P},Symbol.toStringTag,{value:"Module"}));export{h as B,q as W};
